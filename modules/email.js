const utils = require('./utils.js')


const EMAIL_ADDRESS_REGEXP = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
const EMAIL_ADDRESS_REGEXP_RAW = /^\/raw (([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/

var emailInfoString = async (data) => {
	if (typeof data != 'undefined') {
		return await `
		‚úÖ–£—Ä–æ–≤–µ–Ω—å —Ä–µ–ø—É—Ç–∞—Ü–∏–∏ e-mail: ${getLocalizationLevelString(data.reputation)}
		‚ö†–î–æ–ª–∂–Ω–∞ –ª–∏ –ø–æ—á—Ç–∞ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å—Å—è –∫–∞–∫ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è: ${getLocalizationAnswerString(data.suspicious)}
		üìâ–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Ä–µ–ø—É—Ç–∞—Ü–∏–∏: ${data.references}

		–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

		üö´–ü–æ—á—Ç–∞ –∑–∞–Ω–µ—Å–µ–Ω–∞ –≤ —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–∞–∫ —Å–ø–∞–º–æ–≤–∞—è –∏–ª–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–∞—è: ${getLocalizationAnswerString(data.details.blacklisted)}
		‚ö†–ó–∞–º–µ—á–µ–Ω–∞ –ª–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: ${getLocalizationAnswerString(data.details.malicious_activity)}
		‚ö†–ó–∞–º–µ—á–µ–Ω–∞ –ª–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 90 –¥–Ω–µ–π: ${getLocalizationAnswerString(data.details.malicious_activity_recent)}
		üîí–ë—ã–ª–∏ –ª–∏ —É—Ç–µ—á–∫–∏ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö: ${getLocalizationAnswerString(data.details.credentials_leaked)}
		üîí–ë—ã–ª–∏ –ª–∏ —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 90 –¥–Ω–µ–π: ${getLocalizationAnswerString(data.details.credentials_leaked_recent)}
		üîí–ë—ã–ª–∞ –ª–∏ –≤–∑–ª–æ–º–∞–Ω–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞: ${getLocalizationAnswerString(data.details.data_breach)}
		
		‚úÖ–£—Ä–æ–≤–µ–Ω—å —Ä–µ–ø—É—Ç–∞—Ü–∏–∏ –¥–æ–º–µ–Ω–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã: ${getLocalizationLevelString(data.details.domain_reputation)}
		‚úÖ–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π –¥–æ–º–µ–Ω: ${getLocalizationAnswerString(data.details.domain_exists)}
		üÜì–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–∏ –ø–æ—á—Ç–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–æ–º–µ–Ω: ${getLocalizationAnswerString(data.details.free_provider)}
		üÜï–î–æ–º–µ–Ω –±—ã–ª —Å–æ–∑–¥–∞–Ω –º–µ–Ω—å—à–µ –≥–æ–¥–∞ –Ω–∞–∑–∞–¥: ${getLocalizationAnswerString(data.details.new_domain)}
		‚è∞–î–Ω–µ–π —Å —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–º–µ–Ω–∞: ${data.details.days_since_domain_creation}
		‚ö†–ü–æ–¥–¥–µ–ª—å–Ω—ã–π –ª–∏ –∞–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã: ${getLocalizationAnswerString(data.details.spoofable)}
		üìÖ–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–π / –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å: ${getLocalizationAnswerString(data.details.disposable)}

		üìã–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ç—Ä–æ–≥–∞—è –∑–∞–ø–∏—Å—å SPF –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–¥–º–µ–Ω—ã: ${getLocalizationAnswerString(data.details.spf_strict)}
		üìãDMARC –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è: ${getLocalizationAnswerString(data.details.dmarc_enforced)}
		üìã–ò–º–µ–µ—Ç –∑–∞–ø–∏—Å—å MX:  ${getLocalizationAnswerString(data.details.valid_mx)}

		üåö–û–Ω–ª–∞–π–Ω —Å–µ—Ä–≤–∏—Å—ã –≤ –∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–º–µ—á–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω–æ–π –ø–æ—á—Ç—ã: ${data.details.profiles}
		`;
	}
	else {
		throw new Error(`Can not parsed data.`)
	}
}

var getLocalizationAnswerString = (answer) => {
	return answer ? `–î–∞` : `–ù–µ—Ç`
}

var getLocalizationLevelString = (answer) => {
	if (answer === `low`) {
		return `–ù–∏–∑–∫–∏–π`; 
	}
	else if (answer === `medium`) {
		return `–°—Ä–µ–¥–Ω–∏–π`;
	}
	else if (answer === `high`) {
		return `–í—ã—Å–æ–∫–∏–π`;
	}
	else if  (answer === `none`) {
		return `–ù–µ–∏–∑–≤–µ—Å—Ç–µ–Ω`
	}
	else {
		return answer;
	}
}


module.exports = {
	emailInfoString, 
	EMAIL_ADDRESS_REGEXP,
	EMAIL_ADDRESS_REGEXP_RAW
};